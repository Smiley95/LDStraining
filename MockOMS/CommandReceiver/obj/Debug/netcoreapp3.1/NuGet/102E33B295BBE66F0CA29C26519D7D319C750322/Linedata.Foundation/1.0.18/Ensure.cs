// <auto-generated />
// ReSharper disable CheckNamespace


namespace CommandReceiver.Utils
{
    using System;
    using System.Collections.Generic;
    using CodeAnalysis = System.Diagnostics.CodeAnalysis;
    using System.Linq;
    using CommandReceiver.Annotations;

    [CodeAnalysis.ExcludeFromCodeCoverage]
    [UsedImplicitly(ImplicitUseTargetFlags.WithMembers)]
    static class Ensure
    {
        /// <summary>
        /// Ensure that the argument is not null (throw exception if it is)
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("argument: null => halt")]
        [NotNull]
        public static T IsNotNull<T>([NoEnumeration] T argument, string argumentName)
            where T : class
        {
            if (argument == null)
                throw new ArgumentNullException(argumentName);

            return argument;
        }

        /// <summary>
        /// Ensure that the argument is not null (throw exception if it is)
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("argument: null => halt")]
        public static T IsNotNull<T>([NoEnumeration] T? argument, string argumentName)
            where T : struct
        {
            if (argument == null)
                throw new ArgumentNullException(argumentName);

            return argument.Value;
        }

        /// <summary>
        /// Ensure that the argument (a string) is neither null nor empty (throw an exception if it is)
        /// </summary>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("argument: null => halt")]
        [NotNull]
        public static string IsNotNullOrEmpty(string argument, string argumentName)
        {
            if (string.IsNullOrEmpty(argument))
                throw new ArgumentNullException(argumentName);

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a string) is neither null nor whitespace (throw an exception if it is)
        /// </summary>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("argument: null => halt")]
        [NotNull]
        public static string IsNotNullOrWhiteSpace(string argument, string argumentName)
        {
            if (string.IsNullOrWhiteSpace(argument))
                throw new ArgumentNullException(argumentName);

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (ICollection) is neither null nor empty (throw an exception if it is)
        /// </summary>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("argument: null => halt")]
        [NotNull]
        public static ICollection<T> IsNotNullOrEmpty<T>([NoEnumeration] ICollection<T> argument, string argumentName)
        {
            if (argument == null)
                throw new ArgumentNullException(argumentName);

            if (argument.Count < 1)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " must have items.");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &gt;0 (throw an exception if it is &lt;=0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static int IsPositive(int number, string argumentName)
        {
            if (number <= 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be positive.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &gt;0 (throw an exception if it is &lt;=0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static long IsPositive(long number, string argumentName)
        {
            if (number <= 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be positive.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &gt;0 (throw an exception if it is &lt;=0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static decimal IsPositive(decimal number, string argumentName)
        {
            if (number <= 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be positive.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &gt;=0 (throw an exception if it is &lt;0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static long IsNonNegative(long number, string argumentName)
        {
            if (number < 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be non negative.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &gt;=0 (throw an exception if it is &lt;0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static int IsNonNegative(int number, string argumentName)
        {
            if (number < 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be non negative.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &gt;=0 (throw an exception if it is &lt;0)
        /// </summary>
        /// <param name="number"></param>
        /// <param name="argumentName"></param>
        public static decimal IsNonNegative(decimal number, string argumentName)
        {
            if (number < 0)
                throw new ArgumentOutOfRangeException(argumentName, argumentName + " should be non negative.");

            return number;
        }

        /// <summary>
        /// Ensure that the argument (a Guid?) is not null or empty (throw an exception if it is)
        /// </summary>
        /// <param name="guid"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("guid: null => halt")]
        public static Guid IsNotNullOrEmptyGuid(Guid? guid, string argumentName)
        {
            if (guid == null)
                throw new ArgumentNullException(argumentName);
            if (Guid.Empty == guid)
                throw new ArgumentException(argumentName, argumentName + " shoud be non-empty GUID.");

            return guid.Value;
        }

        /// <summary>
        /// Ensure that the argument (a Guid) is not empty (throw an exception if it is)
        /// </summary>
        /// <param name="guid"></param>
        /// <param name="argumentName"></param>
        public static Guid IsNotEmptyGuid(Guid guid, string argumentName)
        {
            if (Guid.Empty == guid)
                throw new ArgumentException(argumentName, argumentName + " shoud be non-empty GUID.");

            return guid;
        }

        /// <summary>
        /// Ensure that the argument (an int) is equal to an expected value (throw an exception if it is not)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="actual"></param>
        /// <param name="argumentName"></param>
        public static void IsEqual(int expected, int actual, string argumentName)
        {
            if (expected != actual)
                throw new ArgumentException($"{argumentName} expected value: {expected}, actual value: {actual}");
        }

        /// <summary>
        /// Ensure that the argument (a long) is equal to an expected value (throw an exception if it is not)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="actual"></param>
        /// <param name="argumentName"></param>
        public static void IsEqual(long expected, long actual, string argumentName)
        {
            if (expected != actual)
                throw new ArgumentException($"{argumentName} expected value: {expected}, actual value: {actual}");
        }

        /// <summary>
        /// Ensure that the argument (a bool) is equal to an expected value (throw an exception if it is not)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="actual"></param>
        /// <param name="argumentName"></param>
        public static void IsEqual(bool expected, bool actual, string argumentName)
        {
            if (expected != actual)
                throw new ArgumentException($"{argumentName} expected value: {expected}, actual value: {actual}");
        }

        /// <summary>
        /// Ensure that the argument (a Guid) is equal to an expected value (throw an exception if it is not)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="actual"></param>
        /// <param name="argumentName"></param>
        public static void IsEqual(Guid expected, Guid actual, string argumentName)
        {
            if (expected != actual)
                throw new ArgumentException($"{argumentName} expected value: {expected}, actual value: {actual}");
        }

        /// <summary>
        /// Ensure that the argument (an int) is equal to SOME (any) power of 2 (throw an exception if it is not)
        /// </summary>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsPowerOf2(int argument, string argumentName)
        {
            if (argument <= 0 || ((uint)argument & ((uint)argument - 1)) != 0)
                throw new ArgumentException($"{argumentName}: {argument} is not a power of 2");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &lt; some expected value (throw an exception if it is &gt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsLessThan(int expected, int argument, string argumentName)
        {
            if (argument >= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &lt; some expected value (throw an exception if it is &gt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsLessThan(long expected, long argument, string argumentName)
        {
            if (argument >= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &lt; some expected value (throw an exception if it is &gt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsLessThan(decimal expected, decimal argument, string argumentName)
        {
            if (argument >= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &lt;= some expected value (throw an exception if it is &gt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsLessThanOrEqualTo(int expected, int argument, string argumentName)
        {
            if (argument > expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &lt;= some expected value (throw an exception if it is &gt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsLessThanOrEqualTo(long expected, long argument, string argumentName)
        {
            if (argument > expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &lt;= some expected value (throw an exception if it is &gt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsLessThanOrEqualTo(decimal expected, decimal argument, string argumentName)
        {
            if (argument > expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be less than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &gt; some expected value (throw an exception if it is &lt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsGreaterThan(int expected, int argument, string argumentName)
        {
            if (argument <= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &gt; some expected value (throw an exception if it is &lt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsGreaterThan(long expected, long argument, string argumentName)
        {
            if (argument <= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &gt; some expected value (throw an exception if it is &lt;= expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsGreaterThan(decimal expected, decimal argument, string argumentName)
        {
            if (argument <= expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is &gt;= some expected value (throw an exception if it is &lt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsGreaterThanOrEqualTo(int expected, int argument, string argumentName)
        {
            if (argument < expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is &gt;= some expected value (throw an exception if it is &lt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsGreaterThanOrEqualTo(long expected, long argument, string argumentName)
        {
            if (argument < expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is &gt;= some expected value (throw an exception if it is &lt; expected)
        /// </summary>
        /// <param name="expected"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsGreaterThanOrEqualTo(decimal expected, decimal argument, string argumentName)
        {
            if (argument < expected)
                throw new ArgumentException(
                    $"{argumentName} expected to be greater than: {expected}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is between 2 other values such that low &lt; argument &gt; high (throw an exception
        /// if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsBetween(int low, int high, int argument, string argumentName)
        {
            if (argument <= low || argument >= high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is between 2 other values such that low &lt; argument &gt; high (throw an exception
        /// if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsBetween(long low, long high, long argument, string argumentName)
        {
            if (argument <= low || argument >= high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is between 2 other values such that low &lt; argument &gt; high (throw an
        /// exception if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsBetween(decimal low, decimal high, decimal argument, string argumentName)
        {
            if (argument <= low || argument >= high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high}, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (an int) is between or equal to 2 other values such that low &lt;= argument &gt;= high (throw
        /// an exception if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static int IsBetweenOrEqual(int low, int high, int argument, string argumentName)
        {
            if (argument < low || argument > high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high} or equal, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a long) is between or equal to 2 other values such that low &lt;= argument &gt;= high (throw
        /// an exception if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static long IsBetweenOrEqual(long low, long high, long argument, string argumentName)
        {
            if (argument < low || argument > high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high} or equal, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that the argument (a decimal) is between or equal to 2 other values such that low &lt;= argument &gt;= high
        /// (throw an exception if it is not)
        /// </summary>
        /// <param name="low"></param>
        /// <param name="high"></param>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static decimal IsBetweenOrEqual(decimal low, decimal high, decimal argument, string argumentName)
        {
            if (argument < low || argument > high)
                throw new ArgumentException(
                    $"{argumentName} expected to be between {low} and {high} or equal, actual value: {argument}");

            return argument;
        }

        /// <summary>
        /// Ensure that expected is not equal to the uninitialized value,  generally indicating that is has been set (throw an
        /// exception if it is)
        /// </summary>
        /// <param name="argument"></param>
        /// <param name="argumentName"></param>
        public static DateTime IsNotDefault(DateTime argument, string argumentName)
        {
            if (argument == DateTime.MinValue)
                throw new ArgumentException(
                    argumentName,
                    $"{argumentName} is equal to the default value :{DateTime.MinValue}");

            return argument;
        }

        /// <summary>
        /// Ensure that the dictionary contains the specified key (throw an exception if it is not)
        /// </summary>
        /// <param name="lookup"></param>
        /// <param name="key"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("lookup: null => halt")]
        public static void ContainsKey<TKey, TValue>(Dictionary<TKey, TValue> lookup, TKey key, string argumentName)
        {
            IsNotNull(lookup, argumentName);
            if (!lookup.ContainsKey(key))
                throw new ArgumentException(
                    $"{argumentName} expected to contain the key {key}, but it was not found.");
        }

        /// <summary>
        /// Ensure that the enumerable contains the specified item (throw an exception if it is not)
        /// </summary>
        /// <param name="lookup"></param>
        /// <param name="value"></param>
        /// <param name="argumentName"></param>
        [ContractAnnotation("lookup: null => halt")]
        public static void Contains<T>(IEnumerable<T> lookup, T value, string argumentName)
        {
            IsNotNull(lookup, argumentName);
            if (!lookup.Contains(value))
                throw new ArgumentException(
                    $"{argumentName} expected to contain the value {value}, but it was not found.");
        }

        public static void IsTrue(Func<bool> expression, string expressionAsString)
        {
            if (!expression())
                throw new ArgumentException($"{expressionAsString} expected to be true, but is found to be false.");
        }

        public static void IsFalse(Func<bool> expression, string expressionAsString)
        {
            if (expression())
                throw new ArgumentException($"{expressionAsString} expected to be false, but is found to be true.");
        }
    }
}
